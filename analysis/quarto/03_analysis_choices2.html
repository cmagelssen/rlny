<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Model: Strategy selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="03_analysis_choices2_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_analysis_choices2_files/libs/quarto-html/quarto.js"></script>
<script src="03_analysis_choices2_files/libs/quarto-html/popper.min.js"></script>
<script src="03_analysis_choices2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03_analysis_choices2_files/libs/quarto-html/anchor.min.js"></script>
<link href="03_analysis_choices2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_analysis_choices2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_analysis_choices2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03_analysis_choices2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03_analysis_choices2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model: Strategy selection</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This quarto file analyzes the strategy choices made by coaches and skiers. Every analysis reported in the paper related to strategy selection can be found here. We start by loading the necessary packages and a custom function for data analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># For data manipulation </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># For statistical modelling</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest) <span class="co"># For statistical modelling</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co"># To create publication-ready figures</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats) <span class="co"># For model diagnostics</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># For estimating marginal effects </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># For </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># To create tables</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../../themes/themes.R"</span>) <span class="co"># This is a custom theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we load in the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We load the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/data_analysis/data_analysis.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,067 × 16
   skigroup skier treatment session  trial strategy best_strategy_first
   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;              
 1 a            1 slfc      baseline     1 ns       d                  
 2 a            1 slfc      baseline     2 ns       d                  
 3 a            1 slfc      baseline     3 ns       d                  
 4 a            1 slfc      baseline     4 ns       d                  
 5 a            1 slfc      block1       5 a        d                  
 6 a            1 slfc      block1       6 c        d                  
 7 a            1 slfc      block1       7 b        d                  
 8 a            1 slfc      block1       8 d        d                  
 9 a            1 slfc      block1       9 d        d                  
10 a            1 slfc      block1      10 c        d                  
# ℹ 3,057 more rows
# ℹ 9 more variables: best_strategy_last &lt;chr&gt;, theory_best &lt;chr&gt;,
#   racingtime &lt;dbl&gt;, chose_best_strategy &lt;dbl&gt;, chose_theoretical_best &lt;dbl&gt;,
#   regret_a &lt;dbl&gt;, regret_b &lt;dbl&gt;, regret_c &lt;dbl&gt;, regret_d &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Please note that “block1,” “block2,” and “block3” correspond to “forced exploration,” “free choice 1,” and “free choice 2”. We organized it this way in the tibble for easier formatting.</p>
<section id="descriptive" class="level1">
<h1>Descriptive</h1>
<section id="descriptive-calculation" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-calculation">Descriptive: Calculation</h2>
<p>Here, we create a tibble with the descriptive statistics of coaches’ and skiers’ choices for each session.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the sessions we want to analysis</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>d_freechoice <span class="ot">&lt;-</span> <span class="fu">filter</span>(d, session <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"block2"</span>, <span class="st">"block3"</span>, <span class="st">"retention"</span>, <span class="st">"transfer"</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we count and calculate the percentage for each strategy for each skier in the dataset</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice <span class="ot">&lt;-</span> d_freechoice <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skigroup, skier, session, treatment) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">a =</span> <span class="fu">sum</span>(strategy <span class="sc">==</span> <span class="st">'a'</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">sum</span>(strategy <span class="sc">==</span> <span class="st">'b'</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> <span class="fu">sum</span>(strategy <span class="sc">==</span> <span class="st">'c'</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">d =</span> <span class="fu">sum</span>(strategy <span class="sc">==</span> <span class="st">'d'</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">total =</span> <span class="fu">sum</span>(a,b,c,d),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">a_percent =</span> <span class="fu">round</span>(a <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">b_percent =</span> <span class="fu">round</span>(b <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">c_percent =</span> <span class="fu">round</span>(c <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">d_percent =</span> <span class="fu">round</span>(d <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">0</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 384 × 13
   skigroup skier session   treatment     a     b     c     d total a_percent
   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;
 1 a            1 block2    slfc          0     1     3     2     6         0
 2 a            1 block3    slfc          0     2     2     2     6         0
 3 a            1 retention slfc          0     1     1     2     4         0
 4 a            1 transfer  slfc          0     1     1     2     4         0
 5 a            2 block2    slfc          0     2     0     4     6         0
 6 a            2 block3    slfc          0     2     2     2     6         0
 7 a            2 retention slfc          0     1     0     3     4         0
 8 a            2 transfer  slfc          0     1     0     3     4         0
 9 a            3 block2    rl            0     2     1     3     6         0
10 a            3 block3    rl            0     3     0     3     6         0
# ℹ 374 more rows
# ℹ 3 more variables: b_percent &lt;dbl&gt;, c_percent &lt;dbl&gt;, d_percent &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Then we calculate the mean and sd for strategy for each treatment and session</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice_mean <span class="ot">&lt;-</span> agg_d_freechoice <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(session, treatment) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">a =</span> <span class="fu">mean</span>(a_percent),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">mean</span>(b_percent),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> <span class="fu">mean</span>(c_percent),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">d =</span> <span class="fu">mean</span>(d_percent)) <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(a, b, c, d), <span class="at">names_to =</span> <span class="st">"strategy"</span>, <span class="at">values_to =</span> <span class="st">"percentage"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice_sd <span class="ot">&lt;-</span> agg_d_freechoice <span class="sc">|&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(session, treatment) <span class="sc">|&gt;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">a =</span> <span class="fu">sd</span>(a_percent),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">sd</span>(b_percent),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">c =</span> <span class="fu">sd</span>(c_percent),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">d =</span> <span class="fu">sd</span>(d_percent)) <span class="sc">|&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(a, b, c, d), <span class="at">names_to =</span> <span class="st">"strategy"</span>, <span class="at">values_to =</span> <span class="st">"sd"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice <span class="ot">&lt;-</span> agg_d_freechoice_mean <span class="sc">|&gt;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(agg_d_freechoice_sd, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"session"</span>, <span class="st">"strategy"</span>, <span class="st">"treatment"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sd_value_high =</span> percentage <span class="sc">+</span> sd,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_value_low =</span> percentage <span class="sc">-</span> sd</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 7
   session treatment strategy percentage    sd sd_value_high sd_value_low
   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
 1 block2  rl        a              0     0             0            0   
 2 block2  rl        b             43.4  20.9          64.3         22.5 
 3 block2  rl        c             11.3  14.2          25.4         -2.89
 4 block2  rl        d             45.5  22.7          68.2         22.8 
 5 block2  slfc      a              1.55  4.96          6.51        -3.42
 6 block2  slfc      b             38.8  27.5          66.3         11.2 
 7 block2  slfc      c             13.7  15.2          28.9         -1.54
 8 block2  slfc      d             45.9  29.8          75.7         16.1 
 9 block2  slts      a              0     0             0            0   
10 block2  slts      b              0     0             0            0   
# ℹ 38 more rows</code></pre>
</div>
</div>
</section>
<section id="descriptive-figure" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-figure">Descriptive: figure</h2>
<p>We create a plot of the raw data to include in the figure</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>agg_d_freechoice <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> percentage, <span class="at">fill =</span> treatment, <span class="at">group =</span> <span class="fu">interaction</span>(session, strategy))) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> sd_value_low, <span class="at">ymax =</span> sd_value_high, <span class="at">group =</span> strategy, <span class="at">fill =</span> treatment), <span class="at">alpha =</span> <span class="fl">0.075</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> strategy, <span class="at">color =</span> treatment)) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> point_size, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> stroke_size) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment, <span class="at">labeller =</span> <span class="fu">labeller</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">c</span>(<span class="at">rl =</span> <span class="st">"Reinforcement</span><span class="sc">\n</span><span class="st">learning"</span>, <span class="at">slfc =</span> <span class="st">"Supervised</span><span class="sc">\n</span><span class="st">(free choice)"</span>, <span class="at">slts =</span> <span class="st">"Supervised</span><span class="sc">\n</span><span class="st">(target skill)"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colorPalette) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorPalette, <span class="at">name =</span> <span class="st">"Treatment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Reinforcement</span><span class="sc">\n</span><span class="st">learning'</span>, <span class="st">'Supervised</span><span class="sc">\n</span><span class="st">(free choice)'</span>, <span class="st">'Supervised learning</span><span class="sc">\n</span><span class="st">(target skill)'</span>)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"block2"</span> <span class="ot">=</span> <span class="st">"Free choice 1"</span>, <span class="st">"block3"</span> <span class="ot">=</span> <span class="st">"Free choice 2"</span>, <span class="st">"retention"</span> <span class="ot">=</span> <span class="st">"Retention"</span>, <span class="st">"transfer"</span> <span class="ot">=</span> <span class="st">"Transfer"</span>)) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">25</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">120</span>)) <span class="sc">+</span>  <span class="co"># Set breaks and limits for y-axis</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Strategy selection during free choice 1 and 2, retention and transfer"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Percentage strategy selection (%)"</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  theme_rlstudy <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analysis_choices2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("test2.svg", device="svg", width=120,height=90, unit="mm")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="selection-of-theoretical-and-estimated-best-strategy" class="level1">
<h1>Selection of theoretical and estimated best strategy</h1>
<p>We will fit a multilevel generalized logistic regression model. Unfortunately, we were not able to run any models with supervised (target skill) learning because they always or nearly always picked the best strategy, so had to exclude this treatment group from the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We filter rl and slfc because slts only select one strategy.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We were unable to fit the model with slts</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>d_freechoice <span class="ot">&lt;-</span> <span class="fu">filter</span>(d_freechoice, treatment <span class="sc">!=</span> <span class="st">"slts"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>d_freechoice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,255 × 16
   skigroup skier treatment session trial strategy best_strategy_first
   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;              
 1 a            1 slfc      block2     13 c        d                  
 2 a            1 slfc      block2     14 c        d                  
 3 a            1 slfc      block2     15 d        d                  
 4 a            1 slfc      block2     16 d        d                  
 5 a            1 slfc      block2     17 c        d                  
 6 a            1 slfc      block2     18 b        d                  
 7 a            1 slfc      block3     19 b        d                  
 8 a            1 slfc      block3     20 d        d                  
 9 a            1 slfc      block3     21 c        d                  
10 a            1 slfc      block3     22 c        d                  
# ℹ 1,245 more rows
# ℹ 9 more variables: best_strategy_last &lt;chr&gt;, theory_best &lt;chr&gt;,
#   racingtime &lt;dbl&gt;, chose_best_strategy &lt;dbl&gt;, chose_theoretical_best &lt;dbl&gt;,
#   regret_a &lt;dbl&gt;, regret_b &lt;dbl&gt;, regret_c &lt;dbl&gt;, regret_d &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We set up contrast codes. We use the simple coding scheme</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple code treatment</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>d_freechoice <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d_freechoice, <span class="at">treatment=</span><span class="fu">as.factor</span>(treatment)) <span class="co"># Turn it into factor</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>d_freechoice<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">relevel</span>(d_freechoice<span class="sc">$</span>treatment, <span class="at">ref =</span> <span class="st">"rl"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>treatmentcoding <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">2</span>) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>treatment_simplecoded <span class="ot">&lt;-</span> treatmentcoding <span class="sc">-</span> matrix</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(d_freechoice<span class="sc">$</span>treatment) <span class="ot">&lt;-</span> treatment_simplecoded</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple code session</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>d_freechoice <span class="ot">&lt;-</span> <span class="fu">mutate</span>(d_freechoice, <span class="at">session=</span><span class="fu">as.factor</span>(session))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>treatmentcoding <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">4</span>) </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">12</span>), <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>session_simplecoded <span class="ot">&lt;-</span> treatmentcoding <span class="sc">-</span> matrix</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(d_freechoice<span class="sc">$</span>session) <span class="ot">&lt;-</span> session_simplecoded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="selection-of-the-theoretical-best-strategy" class="level2">
<h2 class="anchored" data-anchor-id="selection-of-the-theoretical-best-strategy">Selection of the theoretical best strategy</h2>
<p>We run the glmer() model from the lme4 package and log the summary output on the log-odds scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chose_theoretica_best consists of 0s and 1s</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>model_theorybest_1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(chose_theoretical_best <span class="sc">~</span> treatment <span class="sc">*</span> session <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> skigroup<span class="sc">/</span>skier),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> d_freechoice)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_theorybest_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: chose_theoretical_best ~ treatment * session + (1 | skigroup/skier)
   Data: d_freechoice

     AIC      BIC   logLik deviance df.resid 
  1335.0   1386.4   -657.5   1315.0     1245 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2136 -0.5831  0.1953  0.5783  3.7039 

Random effects:
 Groups         Name        Variance Std.Dev.
 skier:skigroup (Intercept) 3.2240   1.7956  
 skigroup       (Intercept) 0.2489   0.4989  
Number of obs: 1255, groups:  skier:skigroup, 63; skigroup, 4

Fixed effects:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           0.2265     0.3470   0.653 0.513828    
treatment2            0.4809     0.4828   0.996 0.319194    
session2              0.2007     0.1804   1.112 0.265925    
session3              0.7928     0.2090   3.794 0.000148 ***
session4              1.1628     0.2120   5.486 4.11e-08 ***
treatment2:session2   0.2661     0.3608   0.738 0.460806    
treatment2:session3   1.0292     0.4175   2.465 0.013699 *  
treatment2:session4   0.8630     0.4225   2.043 0.041059 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) trtmn2 sessn2 sessn3 sessn4 trt2:2 trt2:3
treatment2  -0.023                                          
session2     0.002  0.002                                   
session3     0.038  0.008  0.438                            
session4     0.038  0.014  0.433  0.396                     
trtmnt2:ss2  0.002  0.002 -0.006  0.002  0.003              
trtmnt2:ss3  0.005  0.055  0.002  0.028  0.021  0.438       
trtmnt2:ss4  0.009  0.055  0.003  0.020  0.060  0.434  0.394</code></pre>
</div>
</div>
<p>We derive the estimated probability of choosing the theoretical best strategy using the <code>emmeans</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>emm_model_theorybest <span class="ot">=</span> <span class="fu">emmeans</span>(model_theorybest_1, <span class="at">specs =</span> <span class="sc">~</span> treatment <span class="sc">*</span> session, <span class="at">type =</span> <span class="st">"response"</span>) <span class="co">#Note the response argument, which converts from log-odds to probabilities</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>emm_model_theorybest_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emm_model_theorybest) </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>emm_model_theorybest_tibble </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  treatment session    prob     SE    df asymp.LCL asymp.UCL
  &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 rl        block2    0.430 0.111    Inf     0.237     0.647
2 slfc      block2    0.415 0.108    Inf     0.230     0.629
3 rl        block3    0.446 0.112    Inf     0.249     0.662
4 slfc      block3    0.498 0.111    Inf     0.294     0.703
5 rl        retention 0.499 0.118    Inf     0.282     0.716
6 slfc      retention 0.724 0.0934   Inf     0.512     0.868
7 rl        transfer  0.610 0.112    Inf     0.383     0.798
8 slfc      transfer  0.778 0.0816   Inf     0.581     0.898</code></pre>
</div>
</div>
<p>We want the estimates converted into latex format. We will use this function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>write_emmeans_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(emmeans_data, model_name) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  d_emmean <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emmeans_data)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(model_name)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create the folder if it doesn't exist</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  folder_path <span class="ot">&lt;-</span> <span class="st">"../../latex/statistics/choice"</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(folder_path)) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(folder_path)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over every row in d_emmean</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d_emmean)) {</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> d_emmean[i, ]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    treatment <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>treatment)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    session <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>session)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>prob, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    report <span class="ot">&lt;-</span> <span class="fu">paste</span>(prob)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder_path, <span class="fu">paste</span>(<span class="st">"predictedprob_"</span>,model_name,<span class="st">"_"</span>,treatment,<span class="st">"_"</span>,session,<span class="st">".tex"</span>))</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, filename, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(report, <span class="at">file =</span> filename)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="fu">write_emmeans_prob</span>(emm_model_theorybest,<span class="st">"choice_theorybest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are interested in the contrast at each session. We derive these from emmeans package with <code>pairs()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest <span class="ot">&lt;-</span> <span class="fu">pairs</span>(<span class="fu">regrid</span>(emm_model_theorybest), <span class="at">by =</span> <span class="st">"session"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">transform =</span> <span class="st">"none"</span>, <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(contrast_emm_model_theorybest) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_tibble <span class="ot">&lt;-</span> contrast_emm_model_theorybest_tibble <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_minus_"</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 9
  contrast      session estimate    SE    df asymp.LCL asymp.UCL z.ratio p.value
  &lt;chr&gt;         &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 rl_minus_slfc block2    0.0143 0.128   Inf    -0.237    0.266    0.111  0.911 
2 rl_minus_slfc block3   -0.0517 0.131   Inf    -0.308    0.205   -0.395  0.693 
3 rl_minus_slfc retent…  -0.225  0.129   Inf    -0.477    0.0265  -1.75   0.0794
4 rl_minus_slfc transf…  -0.168  0.119   Inf    -0.401    0.0656  -1.41   0.159 </code></pre>
</div>
</div>
<p>We want to report these contrast in the paper. Therefore, we have created this function that converts this test statistics into latex code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>write_contrasts_z_session <span class="ot">&lt;-</span> <span class="cf">function</span>(emmeans_data, model_name) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  d_emmean <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emmeans_data)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(model_name)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the folder if it doesn't exist</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  folder_path <span class="ot">&lt;-</span> <span class="st">"../../latex/statistics/choice"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(folder_path)) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(folder_path)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  p_value_writer <span class="ot">&lt;-</span> <span class="cf">function</span>(p_value) {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    symbol <span class="ot">&lt;-</span><span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>,<span class="st">" = "</span>, <span class="st">" &lt; "</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    p_value_format <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="fu">formatC</span>(<span class="fu">round</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">format =</span> <span class="st">"f"</span>), <span class="st">"0.001"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    write_p_value <span class="ot">&lt;-</span> <span class="fu">paste</span>(symbol, p_value_format)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(write_p_value )</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over every row in d_emmean</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d_emmean)) {</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> d_emmean[i, ]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    contrast <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>contrast)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    session <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>session)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>estimate, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    statistic <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>z.ratio, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    ci_low <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.LCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    ci_high <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.UCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> row<span class="sc">$</span>p.value</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    report <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta$ ="</span>, beta, <span class="st">", 95</span><span class="sc">\\</span><span class="st">% CI ["</span>,ci_low, <span class="st">", "</span>, ci_high, <span class="st">"], $z$ ="</span>, statistic, <span class="st">", $p$"</span>, <span class="fu">p_value_writer</span>(p_value))</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder_path, <span class="fu">paste</span>(<span class="st">"contrast_"</span>,model_name,<span class="st">"_"</span>,contrast,<span class="st">"_"</span>,session,<span class="st">".tex"</span>))</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, filename, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(report, <span class="at">file =</span> filename)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="fu">write_contrasts_z_session</span>(contrast_emm_model_theorybest_tibble, <span class="st">"choice_theorybest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are also interested in the change in predicted prob for each session. We derive these from emmeans package with <code>pairs()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_diff <span class="ot">&lt;-</span> <span class="fu">pairs</span>(<span class="fu">regrid</span>(emm_model_theorybest), <span class="at">by =</span> <span class="st">"treatment"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">transform =</span> <span class="st">"none"</span>, <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>), <span class="at">reverse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_diff_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(contrast_emm_model_theorybest_diff) </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_diff_tibble <span class="ot">&lt;-</span> contrast_emm_model_theorybest_diff_tibble <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_minus_"</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_theorybest_diff_tibble </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 9
   contrast  treatment estimate     SE    df asymp.LCL asymp.UCL z.ratio p.value
   &lt;chr&gt;     &lt;fct&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 block3_m… rl          0.0167 0.0630   Inf   -0.107      0.140   0.264 7.91e-1
 2 retentio… rl          0.0691 0.0723   Inf   -0.0726     0.211   0.956 3.39e-1
 3 retentio… rl          0.0524 0.0724   Inf   -0.0895     0.194   0.724 4.69e-1
 4 transfer… rl          0.181  0.0699   Inf    0.0435     0.318   2.58  9.81e-3
 5 transfer… rl          0.164  0.0701   Inf    0.0265     0.301   2.34  1.94e-2
 6 transfer… rl          0.111  0.0784   Inf   -0.0422     0.265   1.42  1.55e-1
 7 block3_m… slfc        0.0826 0.0628   Inf   -0.0404     0.206   1.32  1.88e-1
 8 retentio… slfc        0.309  0.0672   Inf    0.177      0.441   4.59  4.37e-6
 9 retentio… slfc        0.226  0.0683   Inf    0.0923     0.360   3.31  9.31e-4
10 transfer… slfc        0.362  0.0680   Inf    0.229      0.496   5.33  9.96e-8
11 transfer… slfc        0.280  0.0695   Inf    0.143      0.416   4.02  5.73e-5
12 transfer… slfc        0.0535 0.0631   Inf   -0.0701     0.177   0.848 3.96e-1</code></pre>
</div>
</div>
<p>We write them to latex code with the following function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>write_contrasts_z_treatment <span class="ot">&lt;-</span> <span class="cf">function</span>(emmeans_data, model_name) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  d_emmean <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emmeans_data)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(model_name)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the folder if it doesn't exist</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  folder_path <span class="ot">&lt;-</span> <span class="st">"../../latex/statistics/choice"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(folder_path)) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(folder_path)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  p_value_writer <span class="ot">&lt;-</span> <span class="cf">function</span>(p_value) {</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    symbol <span class="ot">&lt;-</span><span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>,<span class="st">" = "</span>, <span class="st">" &lt; "</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    p_value_format <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="fu">formatC</span>(<span class="fu">round</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">format =</span> <span class="st">"f"</span>), <span class="st">"0.001"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    write_p_value <span class="ot">&lt;-</span> <span class="fu">paste</span>(symbol, p_value_format)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(write_p_value )</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over every row in d_emmean</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d_emmean)) {</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> d_emmean[i, ]</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    contrast <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>contrast)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    treatment <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>treatment)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>estimate, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    statistic <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>z.ratio, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    ci_low <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.LCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    ci_high <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.UCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> row<span class="sc">$</span>p.value</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    report <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta$ ="</span>, beta, <span class="st">", 95</span><span class="sc">\\</span><span class="st">% CI ["</span>,ci_low, <span class="st">", "</span>, ci_high, <span class="st">"], $z$ ="</span>, statistic, <span class="st">", $p$"</span>, <span class="fu">p_value_writer</span>(p_value))</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder_path, <span class="fu">paste</span>(<span class="st">"contrast_"</span>,model_name,<span class="st">"_"</span>,contrast,<span class="st">"_"</span>,treatment,<span class="st">".tex"</span>))</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, filename, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(report, <span class="at">file =</span> filename)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="fu">write_contrasts_z_treatment</span>(contrast_emm_model_theorybest_diff_tibble, <span class="st">"choice_theorybest2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also want to extract the estimated interaction term from the model and save that into a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we extract the interaction effect (i.e. difference-in-difference) from the model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># And we make that into a tibble</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_theorybest <span class="ot">&lt;-</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(emm_model_theorybest), <span class="at">interaction =</span> <span class="st">"pairwise"</span>, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">infer=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>)) </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_theorybest_tibble <span class="ot">&lt;-</span> interaction_emm_model_theorybest <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_theorybest_tibble <span class="ot">&lt;-</span> <span class="fu">rename</span>(interaction_emm_model_theorybest_tibble, <span class="at">contrast =</span> treatment_pairwise) </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_theorybest_tibble <span class="ot">&lt;-</span> interaction_emm_model_theorybest_tibble <span class="sc">|&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_x_"</span>), <span class="at">session =</span> <span class="fu">str_replace_all</span>(session_pairwise, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_x_"</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_theorybest_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  contrast  session_pairwise   estimate     SE    df asymp.LCL asymp.UCL z.ratio
  &lt;chr&gt;     &lt;fct&gt;                 &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 rl_x_slfc block2 - block3      0.0660 0.0889   Inf  -0.108       0.240   0.742
2 rl_x_slfc block2 - retention   0.240  0.0988   Inf   0.0461      0.433   2.43 
3 rl_x_slfc block2 - transfer    0.182  0.0970   Inf  -0.00835     0.372   1.87 
4 rl_x_slfc block3 - retention   0.174  0.0996   Inf  -0.0215      0.369   1.74 
5 rl_x_slfc block3 - transfer    0.116  0.0982   Inf  -0.0765      0.308   1.18 
6 rl_x_slfc retention - trans…  -0.0579 0.100    Inf  -0.255       0.139  -0.577
# ℹ 2 more variables: p.value &lt;dbl&gt;, session &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>write_interactions_z <span class="ot">&lt;-</span> <span class="cf">function</span>(emmeans_data, model_name) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  d_emmean <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emmeans_data)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(model_name)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the folder if it doesn't exist</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  folder_path <span class="ot">&lt;-</span> <span class="st">"../../latex/statistics/choice"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(folder_path)) {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(folder_path)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  p_value_writer <span class="ot">&lt;-</span> <span class="cf">function</span>(p_value) {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    symbol <span class="ot">&lt;-</span><span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>,<span class="st">" = "</span>, <span class="st">" &lt; "</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    p_value_format <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="fu">formatC</span>(<span class="fu">round</span>(p_value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">format =</span> <span class="st">"f"</span>), <span class="st">"0.001"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    write_p_value <span class="ot">&lt;-</span> <span class="fu">paste</span>(symbol, p_value_format)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(write_p_value )</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over every row in d_emmean</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d_emmean)) {</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> d_emmean[i, ]</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    contrast <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>contrast)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    session <span class="ot">&lt;-</span> <span class="fu">as.character</span>(row<span class="sc">$</span>session)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>estimate, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    statistic <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>z.ratio, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    ci_low <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.LCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    ci_high <span class="ot">&lt;-</span> <span class="fu">round</span>(row<span class="sc">$</span>asymp.UCL, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> row<span class="sc">$</span>p.value</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    report <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta$ ="</span>, beta, <span class="st">", 95</span><span class="sc">\\</span><span class="st">% CI ["</span>,ci_low, <span class="st">", "</span>, ci_high, <span class="st">"], $z$ ="</span>, statistic, <span class="st">", $p$"</span>, <span class="fu">p_value_writer</span>(p_value))</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(folder_path, <span class="fu">paste</span>(<span class="st">"interaction_"</span>,model_name,<span class="st">"_"</span>,contrast,<span class="st">"_"</span>,session,<span class="st">".tex"</span>))</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    filename <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, filename, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(report, <span class="at">file =</span> filename)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="fu">write_interactions_z</span>(interaction_emm_model_theorybest_tibble, <span class="st">"choice_theorybest_interaction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we plot the estimated probabilities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> emm_model_theorybest_tibble <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> prob, <span class="at">fill =</span> treatment, <span class="at">color=</span>treatment)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>treatment), <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> prob, <span class="at">color=</span>treatment, <span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL, <span class="at">fill =</span> treatment), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> line_size, <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> point_size, <span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="fl">0.25</span>,  <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colorPalette) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorPalette, <span class="at">name =</span> <span class="st">"Treatment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Reinforcement</span><span class="sc">\n</span><span class="st">learning'</span>, <span class="st">'Supervised</span><span class="sc">\n</span><span class="st">(free choice)'</span>, <span class="st">'Supervised learning</span><span class="sc">\n</span><span class="st">(target skill)'</span>)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"block2"</span> <span class="ot">=</span> <span class="st">"Free choice 1"</span>, <span class="st">"block3"</span> <span class="ot">=</span> <span class="st">"Free choice 2"</span>, <span class="st">"retention"</span> <span class="ot">=</span> <span class="st">"Retention"</span>, <span class="st">"transfer"</span> <span class="ot">=</span> <span class="st">"Transfer"</span>)) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Probability of selecting </span><span class="sc">\n</span><span class="st"> the theoretical best strategy"</span>,  <span class="at">title=</span><span class="st">"Selection of the theoretical best strategy"</span>) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  theme_rlstudy <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_analysis_choices2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("test1.svg", device="svg", width=89, height=65, unit="mm")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selection-of-the-estimated-best-strategy" class="level2">
<h2 class="anchored" data-anchor-id="selection-of-the-estimated-best-strategy">Selection of the estimated best strategy</h2>
<p>Here, we analyze the estimated best strategy. Since we have already selected the right data, we go straight to modelling. We run the glmer() model from the lme4 package and log the summary output on the log-odds scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chose_theoretica_best consists of 0s and 1s</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>model_estimatedbest <span class="ot">&lt;-</span> <span class="fu">glmer</span>(chose_best_strategy <span class="sc">~</span> treatment <span class="sc">*</span> session <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> skigroup<span class="sc">/</span>skier),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> d_freechoice)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_estimatedbest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: chose_best_strategy ~ treatment * session + (1 | skigroup/skier)
   Data: d_freechoice

     AIC      BIC   logLik deviance df.resid 
  1307.0   1358.3   -643.5   1287.0     1245 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1632 -0.6434  0.2921  0.4846  2.5092 

Random effects:
 Groups         Name        Variance Std.Dev.
 skier:skigroup (Intercept) 2.5424   1.5945  
 skigroup       (Intercept) 0.1975   0.4444  
Number of obs: 1255, groups:  skier:skigroup, 63; skigroup, 4

Fixed effects:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          0.91273    0.31129   2.932 0.003367 ** 
treatment2          -0.09387    0.43548  -0.216 0.829341    
session2             0.67126    0.18302   3.668 0.000245 ***
session3             0.76576    0.20817   3.679 0.000235 ***
session4             1.04414    0.21152   4.936 7.96e-07 ***
treatment2:session2 -0.57909    0.36548  -1.584 0.113092    
treatment2:session3  0.37793    0.41554   0.909 0.363092    
treatment2:session4  0.05705    0.42163   0.135 0.892365    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) trtmn2 sessn2 sessn3 sessn4 trt2:2 trt2:3
treatment2  -0.022                                          
session2     0.016 -0.009                                   
session3     0.052  0.005  0.427                            
session4     0.058  0.001  0.425  0.380                     
trtmnt2:ss2 -0.006  0.020 -0.002  0.013  0.010              
trtmnt2:ss3  0.005  0.070  0.015  0.049  0.022  0.424       
trtmnt2:ss4  0.003  0.077  0.012  0.021  0.040  0.422  0.377</code></pre>
</div>
</div>
<p>We derive the estimated probability of choosing the estimated best strategy using the <code>emmeans</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>emm_model_estimatedbest <span class="ot">=</span> <span class="fu">emmeans</span>(model_estimatedbest, <span class="at">specs =</span> <span class="sc">~</span> treatment <span class="sc">*</span> session, <span class="at">type =</span> <span class="st">"response"</span>) <span class="co">#Note the response argument, which converts from log-odds to probabilities</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(emm_model_estimatedbest) </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>emm_model_estimatedbest_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  treatment session    prob     SE    df asymp.LCL asymp.UCL
  &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 rl        block2    0.580 0.0993   Inf     0.383     0.754
2 slfc      block2    0.566 0.0989   Inf     0.372     0.741
3 rl        block3    0.783 0.0707   Inf     0.615     0.891
4 slfc      block3    0.656 0.0913   Inf     0.463     0.808
5 rl        retention 0.711 0.0891   Inf     0.512     0.852
6 slfc      retention 0.772 0.0762   Inf     0.591     0.888
7 rl        transfer  0.792 0.0721   Inf     0.618     0.900
8 slfc      transfer  0.792 0.0717   Inf     0.619     0.899</code></pre>
</div>
</div>
<p>We write these predicted probabilies to latex code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_emmeans_prob</span>(emm_model_estimatedbest,<span class="st">"choice_estimatedbest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are interested in the contrast at each session. We derive these from emmeans package with <code>pairs()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest <span class="ot">&lt;-</span> <span class="fu">pairs</span>(<span class="fu">regrid</span>(emm_model_estimatedbest), <span class="at">by =</span> <span class="st">"session"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">transform =</span> <span class="st">"none"</span>, <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(contrast_emm_model_estimatedbest) </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> contrast_emm_model_estimatedbest_tibble <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_minus_"</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 9
  contrast    session estimate     SE    df asymp.LCL asymp.UCL  z.ratio p.value
  &lt;chr&gt;       &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 rl_minus_s… block2   1.42e-2 0.117    Inf   -0.215      0.244  0.121     0.904
2 rl_minus_s… block3   1.27e-1 0.0977   Inf   -0.0646     0.318  1.30      0.194
3 rl_minus_s… retent… -6.12e-2 0.101    Inf   -0.259      0.136 -0.607     0.544
4 rl_minus_s… transf…  1.30e-4 0.0874   Inf   -0.171      0.171  0.00148   0.999</code></pre>
</div>
</div>
<p>We write to latex</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_contrasts_z_session</span>(contrast_emm_model_estimatedbest_tibble, <span class="st">"choice_estimatedbest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are also interested in the change in predicted prob for each session. We derive these from emmeans package with <code>pairs()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_diff <span class="ot">&lt;-</span> <span class="fu">pairs</span>(<span class="fu">regrid</span>(emm_model_estimatedbest), <span class="at">by =</span> <span class="st">"treatment"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">transform =</span> <span class="st">"none"</span>, <span class="at">infer =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>), <span class="at">reverse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_diff_tibble <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(contrast_emm_model_estimatedbest_diff) </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_diff_tibble <span class="ot">&lt;-</span> contrast_emm_model_estimatedbest_diff_tibble <span class="sc">|&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_minus_"</span>))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>contrast_emm_model_estimatedbest_diff_tibble </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 9
   contrast  treatment estimate     SE    df asymp.LCL asymp.UCL z.ratio p.value
   &lt;chr&gt;     &lt;fct&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 block3_m… rl         0.203   0.0599   Inf   0.0857     0.321    3.39  6.99e-4
 2 retentio… rl         0.131   0.0648   Inf   0.00401    0.258    2.02  4.32e-2
 3 retentio… rl        -0.0722  0.0580   Inf  -0.186      0.0414  -1.25  2.13e-1
 4 transfer… rl         0.212   0.0643   Inf   0.0862     0.338    3.30  9.67e-4
 5 transfer… rl         0.00917 0.0498   Inf  -0.0884     0.107    0.184 8.54e-1
 6 transfer… rl         0.0814  0.0621   Inf  -0.0403     0.203    1.31  1.90e-1
 7 block3_m… slfc       0.0904  0.0613   Inf  -0.0297     0.211    1.48  1.40e-1
 8 retentio… slfc       0.206   0.0663   Inf   0.0763     0.336    3.11  1.87e-3
 9 retentio… slfc       0.116   0.0616   Inf  -0.00497    0.237    1.88  6.02e-2
10 transfer… slfc       0.226   0.0667   Inf   0.0956     0.357    3.39  6.93e-4
11 transfer… slfc       0.136   0.0616   Inf   0.0153     0.257    2.21  2.72e-2
12 transfer… slfc       0.0201  0.0575   Inf  -0.0926     0.133    0.350 7.27e-1</code></pre>
</div>
</div>
<p>We write them to latex</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_contrasts_z_treatment</span>(contrast_emm_model_estimatedbest_diff_tibble, <span class="st">"choice_estimatedbest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also want to extract the estimated interaction term from the model and save that into a tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we extract the interaction effect (i.e. difference-in-difference) from the model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># And we make that into a tibble</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_estimatedbest <span class="ot">&lt;-</span> <span class="fu">contrast</span>(<span class="fu">regrid</span>(emm_model_estimatedbest), <span class="at">interaction =</span> <span class="st">"pairwise"</span>, <span class="at">type =</span> <span class="st">"response"</span>, <span class="at">adjust=</span><span class="st">"none"</span>, <span class="at">infer=</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>)) </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> interaction_emm_model_estimatedbest <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> <span class="fu">rename</span>(interaction_emm_model_estimatedbest_tibble, <span class="at">contrast =</span> treatment_pairwise) </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_estimatedbest_tibble <span class="ot">&lt;-</span> interaction_emm_model_estimatedbest_tibble <span class="sc">|&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_x_"</span>), <span class="at">session =</span> <span class="fu">str_replace_all</span>(session_pairwise, <span class="st">" "</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"-"</span>, <span class="st">"_x_"</span>))</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>interaction_emm_model_estimatedbest_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  contrast  session_pairwise   estimate     SE    df asymp.LCL asymp.UCL z.ratio
  &lt;chr&gt;     &lt;fct&gt;                 &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 rl_x_slfc block2 - block3     -0.113  0.0848   Inf   -0.279     0.0536  -1.33 
2 rl_x_slfc block2 - retention   0.0753 0.0912   Inf   -0.103     0.254    0.826
3 rl_x_slfc block2 - transfer    0.0140 0.0892   Inf   -0.161     0.189    0.157
4 rl_x_slfc block3 - retention   0.188  0.0856   Inf    0.0202    0.356    2.20 
5 rl_x_slfc block3 - transfer    0.127  0.0790   Inf   -0.0281    0.282    1.60 
6 rl_x_slfc retention - trans…  -0.0613 0.0844   Inf   -0.227     0.104   -0.727
# ℹ 2 more variables: p.value &lt;dbl&gt;, session &lt;chr&gt;</code></pre>
</div>
</div>
<p>We write them to latex files</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_interactions_z</span>(interaction_emm_model_estimatedbest_tibble, <span class="st">"choice_estimatedbest_interaction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we plot the estimated probabilities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> emm_model_estimatedbest_tibble <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> prob, <span class="at">fill =</span> treatment, <span class="at">color=</span>treatment)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>treatment), <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> prob, <span class="at">color=</span>treatment, <span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL, <span class="at">fill =</span> treatment), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> line_size, <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> point_size, <span class="at">color =</span> <span class="st">"black"</span>,<span class="at">size =</span> <span class="fl">0.25</span>,  <span class="at">stroke =</span> stroke_size, <span class="at">position=</span><span class="fu">position_dodge</span>(dodge_width)) <span class="sc">+</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colorPalette) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorPalette, <span class="at">name =</span> <span class="st">"Treatment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Reinforcement</span><span class="sc">\n</span><span class="st">learning'</span>, <span class="st">'Supervised</span><span class="sc">\n</span><span class="st">(free choice)'</span>, <span class="st">'Supervised learning</span><span class="sc">\n</span><span class="st">(target skill)'</span>)) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"block2"</span> <span class="ot">=</span> <span class="st">"Free choice 1"</span>, <span class="st">"block3"</span> <span class="ot">=</span> <span class="st">"Free choice 2"</span>, <span class="st">"retention"</span> <span class="ot">=</span> <span class="st">"Retention"</span>, <span class="st">"transfer"</span> <span class="ot">=</span> <span class="st">"Transfer"</span>)) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span><span class="st">"Probability of selecting </span><span class="sc">\n</span><span class="st"> the theoretical best strategy"</span>,  <span class="at">title=</span><span class="st">"Selection of the theoretical best strategy"</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  theme_rlstudy <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_line(aes(group = treatment), stroke = stroke_size, position =
position_dodge(dodge_width)): Ignoring unknown parameters: `stroke`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_linerange(aes(x = session, y = prob, color = treatment, :
Ignoring unknown parameters: `shape` and `stroke`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_linerange(aes(x = session, y = prob, color = treatment, :
Ignoring unknown aesthetics: fill</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated aesthetics after name standardisation: size</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"test1.svg"</span>, <span class="at">device=</span><span class="st">"svg"</span>, <span class="at">width=</span><span class="dv">89</span>, <span class="at">height=</span><span class="dv">65</span>, <span class="at">unit=</span><span class="st">"mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="regret-cost" class="level1">
<h1>Regret / Cost</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_grid(fig_top_left_1,fig_top_left_2, fig_top_right_1, fig_top_right_2, fig_bottom_left_1, fig_bottom_left_2, fig_bottom_right_1, fig_bottom_right_2, axis="lr", align="vh", ncol=4)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("plot_model_estimatedbest.svg", units="cm", width=16, height=8, device="svg")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>